# Provisioner Best Practices

## Adding a device
- Use SmartPBX or Callflows to create a new device. This will ensure SIP credentials are generated in Kazoo. While Advanced Provisioner does have the ability to create a device, it creates one without SIP credentials. 
- It is important to first add a device before adding the Provisioning URL to the device. Provisioner has a security measure where it logs failed attempts at retrieving a config file. Without adding the device first, the device will trigger the security measure and Provisioner logs it as a failed attempt. After 10 unique failed attempts from a given IP, that IP will be banned for an hour. So any phones previously provisioned will also not be able to retrieve their config files.

## Provisioning a device
- [Cisco](./cisco/cisco_provisioning_guide.md)
- [Obihai](./obihai/obihai_provisioning_guide.md)
- [Polycom](./polycom/polycom_provisioning_guide.md)
- [Yealink](./yealink/yealink_provisioning_guide.md)
- Grandstream
    - [GXP21xx Series](./grandstream/gxp21xx_provisioning_guide.md)
- [Htek](./htek/htek_provisioning_guide.md)
- [Alcatel-Lucent Enterprise](./ale/ale_provisioning_guide.md)

## Custom Config Files
- We know that our Provisioner does not cover every feature available in the phones, but some vendors do support multiple config files. You can use custom config files to set features we do not cover with our Provisioner or override settings we don't expose.
- If you are using this feature, we ask that you first test the device without any custom config file settings prior to filing a support ticket with us. It will make troubleshooting issues much smoother.
- Currently the vendors that have Custom Config File support on Provisioner:
    - Yealink (using firmware v81+)
    - Polycom

## Troubleshooting Steps
- Try rebooting the device. 
    - Sometimes it's just a matter of updating the config file.
- Ensure that the base provisioning URL is correct. 
    - By default it should be p3.zswitch.net. If you have it whitelabeled, then please ensure that it resolves to our provisioner server.
    - If the phone is not reaching our provisioner server, then it's not getting any updates on settings.
- Reset the provisioning URL to the base provisioning URL. 
    - Sometimes phones will end up looking in the wrong directory for their config file. This is caused by deleting the device and re-adding it back into Provisioner.
- Factory Reset the phone and reprovision.
    - This is to clear all settings and use only the config file generated by Provisioner.
    - If you have custom config files attached to the device, remove it before factory resetting.
    - After it reprovisions:
        - If the device still isn't working, let us know as it could be an issue with our settings.
        - If the device works, then apply the custom config file again and see if that works. If it doesn't then there's an issue with your custom settings.
